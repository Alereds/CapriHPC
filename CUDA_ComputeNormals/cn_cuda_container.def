Bootstrap: docker
From: nvidia/cuda:10.2-cudnn7-devel-ubuntu18.04

%post
apt-get update
apt-get install -y gcc g++ git nvidia-cuda-toolkit
export CUDA_HOME=/usr/local/cuda
export CPATH=$CPATH:${CUDA_HOME}/include
export LIBRARY_PATH=$LIBRARY_PATH:${CUDA_HOME}/lib64
ln -s /usr/local/cuda/lib64/stubs/libcuda.so /usr/local/cuda/lib64/libcuda.so
mkdir ${SINGULARITY_ROOTFS}/MyRoot
cd ${SINGULARITY_ROOTFS}/MyRoot
git clone https://github.com/Alereds/CapriHPC.git
cd CapriHPC/CUDA_ComputeNormals
nvcc compute_normals.cu -o compute_normals.o

%runscript
cd ${SINGULARITY_ROOTFS}/MyRoot/CapriHPC/CUDA_ComputeNormals
./compute_normals.o

%labels
Author Alessandro Rossi
Version 1.0

%help
This is a simple example of Singularity container. The container
is based on CUDA Toolkit and it contains a C++ program